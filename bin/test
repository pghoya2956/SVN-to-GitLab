#!/bin/bash
set -e

echo "=== Running Tests ==="

# Check if Docker is running
if ! docker info > /dev/null 2>&1; then
  echo "âŒ Docker is not running. Please start Docker and try again."
  exit 1
fi

echo "ğŸ—„ï¸  Setting up test database..."
docker compose run --rm -e RAILS_ENV=test web rails db:create db:migrate

echo "ğŸ§ª Running Rails tests..."
docker compose run --rm -e RAILS_ENV=test web rails test

echo "ğŸ­ Running Playwright tests..."
docker compose run --rm web npx playwright test

echo "âœ… All tests complete!"