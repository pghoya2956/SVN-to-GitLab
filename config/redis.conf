# Redis 영속성 설정
# 이 파일을 docker-compose.yml에서 마운트하여 사용

# RDB (스냅샷) 설정
# 900초(15분) 동안 1개 이상 변경 시 저장
save 900 1
# 300초(5분) 동안 10개 이상 변경 시 저장  
save 300 10
# 60초 동안 10000개 이상 변경 시 저장
save 60 10000

# RDB 파일명
dbfilename dump.rdb

# 저장 디렉토리 (Docker 볼륨)
dir /data

# AOF (Append Only File) 설정 - 더 강력한 영속성
appendonly yes
appendfilename "appendonly.aof"

# AOF 재작성 설정
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# fsync 정책 (everysec = 1초마다 디스크 동기화)
# always: 모든 쓰기마다 (가장 안전, 가장 느림)
# everysec: 1초마다 (균형)
# no: OS에 맡김 (가장 빠름, 덜 안전)
appendfsync everysec

# 메모리 제한
maxmemory 512mb

# 메모리 초과 시 정책
# volatile-lru: TTL 설정된 키 중 LRU 제거
# allkeys-lru: 모든 키 중 LRU 제거
# noeviction: 새 쓰기 거부
maxmemory-policy allkeys-lru